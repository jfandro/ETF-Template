

<div class="overlay"></div>

<video playsinline="playsinline" autoplay="autoplay" muted="muted" loop="loop">
    <source src="~/Content/videos/bg.mp4" type="video/mp4" />
</video>

<div class="container">
    <div class="jumbotron masthead" style="margin-top:150px;">

        <h1>Robo <span class="text-warning">for</span> Advisor</h1>

        <p>
            <strong>Ce site pourrait être le vôtre</strong> mais c'est notre show-room centré sur les services proposés
            par <a target="_blank" href="https://lili.am">la place de marché Lili</a>, une plateforme digitale réservéee aux professionels de la gestion d'actifs.
            Nous allons vous montrer dans ce show-romm, par des exemples concrets, du plus simple au plus complexe,
            comment utiliser et déployer <b>notre API</b> dans un contexte propriétaire sécurisé qui pourrait être votre site web.
            Nous allons vous faire découvrir tout le potentiel de notre approche "open" en faisant notamment appel à la libraire de <b>widgets dataviz</b>
            développés en open source pour offrir le maximum de nouvelles expériences à vos clients.
        </p>
        <div class="signin-container">
            <p>
                To discover Lili services, please enter your username, your
                password, or let <a href="mailto:admin@lili.am?subject=Credentials">email us</a>  to get credentials.
            </p>

            <form id="signin-form" class="signin-form" method="post">
                <div class="form-group">
                    <div class="input-group">
                        <span class="input-group-addon"><i class="glyphicon glyphicon-home"></i></span>
                        <input type="text" class="form-control" id="domain" name="domain" placeholder="Related domain" />
                    </div>
                </div>
                <div class="form-group">
                    <div class="input-group">
                        <span class="input-group-addon"><i class="glyphicon glyphicon-user"></i></span>
                        <input type="text" class="form-control" id="username" name="username" placeholder="Enter your username" />
                    </div>
                </div>
                <div class="form-group">
                    <div class="input-group">
                        <span class="input-group-addon"><i class="glyphicon glyphicon-lock"></i></span>
                        <input type="password" class="form-control" id="password" name="password" placeholder="Your password" />
                    </div>
                </div>
                <div id="ctnErr" class="well hide">
                </div>
                <div class="form-group text-right">
                    <button class="btn btn-primary btn-sm" type="submit">Sign in</button>
                </div>
            </form>
        </div>

        <div class="signoff-container">
            <p class="small">
                Your first experience starts with a sample of <a href="/Home/Allocations">client report</a> related to the portfolio linked to the connected user.
            </p>
            <p>
                <a href="#" class="btn-signout signoff-container">Signout</a>
            </p>
        </div>

    </div>
</div>


@section scripts {
    <script>

        $(document).ready(function () {

            $("#domain").val(LoyolApp.Settings.domain);

            var loginsuccess = function (e) {
                // get the state of current session
                var session = LoyolApp.Session.getInstance().get();
                if (session && session.keepSignedIn && session.token) {
                    $('.signin-container').addClass('hidden');
                    $('.signoff-container').removeClass('hidden');
                } else {
                    $('.signin-container').removeClass('hidden');
                    $('.signoff-container').addClass('hidden');
                }
            };

            var loginfailed = function (e) {
                $ctnErr.html("<p>Oops! Lili had a problem and could not log you on.  Please try again in a few minutes.</p>");
                $ctnErr.addClass("bi-ctn-err").slideDown();
            };

            var loginerror = function (e) {
                $ctnErr.html("<p>Aie! Lili had a problem and could not log you on.  Please try again in a few minutes.</p>");
                $ctnErr.addClass("bi-ctn-err").slideDown();
            };

            var login = function (usr, pwd) {
                // Create a new instance of a controller signin related to the given domain
                var sg = new LoyolApp.SignInController($("#domain").val());
                sg.login(usr, pwd, loginsuccess, loginfailed, loginerror);
                return false;
            }

            // The step of the authentication sequence in our app is to send the user credentials to the server,
            // and wait for a response that will tell us if we can let the user in.
            // We will perform this step inside a template method that we will call onSignInCommand.
            // We will invoke this method when the user pushes the Sign In button in the Sign In Screen
            $('.signin-form').submit(function () {

                var $txtUsername = $('#username'),
                    $txtPassword = $('#password');

                var emailAddress = $txtUsername.val().trim(),
                    password = $txtPassword.val().trim(),
                    invalidInput = false;

                // Flag each invalid field.
                if (emailAddress.length === 0) {
                    invalidInput = true;
                }

                // Check password length
                if (password.length === 0) {
                    invalidInput = true;
                }

                // Make sure that all the required fields have values.
                if (invalidInput) {
                    $ctnErr.html("<p>Please enter all the required fields.</p>");
                    $ctnErr.addClass("bi-ctn-err").slideDown();
                    return;
                }

                return login(emailAddress, password);

            })


            // Sign off = Remove access token from current session + call to refresh
            $('.btn-signout').click(function () {
                LoyolApp.Session.logOff();
                loginsuccess();
            })

            // run it to hide or display form sign-in
            loginsuccess();

        });

    </script>

}
