
@{
    ViewBag.Title = "My fund";
}
<link href="~/Content/mydataviz.css" rel="stylesheet" />
<style>
    .img-td {
        width: 16px;
        height: 16px;
        border: 1px solid #ccc;
    }
</style>

@section header {
    <section class="jumbotron section-header header-image" style="background-image:url('https://www.letelegramme.fr/images/2019/03/25/oceans-un-bien-commun-de-l-humanite-a-defendre-a-l-onu_4484351_540x271p.jpg')">
        <div class="container">
            <h1 class="text-center">Mon Offre</h1>
            <p class="lead text-center">Positionner son offre par rapport à la concurrence</p>
        </div>
    </section>
}

<section class="section-b">
    <div class="container">
        <p>
            Sur cette page, nous allons nous intéresser à 3 fonds (OPCVM ou ETF) émis par une société de gestion 
            pour positionner son offre dans la <b>classe d'actifs</b> de référence.
            Sur la base d'une période passée, l'utilisateur peut voir en seule vue les performances, les volatilités, 
            les profils de risques (couleur d'une bulle) ainsi que les frais de gestion (taille de la bulle)
        </p>
    </div>
</section>

<section class="section-d">
    <div class="container">
        <div class="row text-center">
            @*<div class="form-group col-sm-5">
                <input type="text" class="form-control" id="Code" name="Code" value="" placeholder="Code ISIN ou ticker" />
            </div>*@
            <div class="btn-group btn-group-sm" data-toggle="buttons">
                <label class="btn btn-default btn-fund active" data-code="JREE"><input type="radio" name="fund">Actions Europe</label>
                <label class="btn btn-default btn-fund" data-code="PJPH"><input type="radio" name="fund" >Actions Japon</label>
                <label class="btn btn-default btn-fund" data-code="VUSA"><input type="radio" name="fund">Actions US</label>
            </div>
            <input id="code" type="hidden" value="JREE" />
        </div>
    </div>
    <div class="container" style="margin-top:80px;">
        <div class="row">
            <div class="col-xs-12 dc-panel">
                <div class="btn-group btn-group-xs kpi-group" data-toggle="buttons" data-chart="#asset-bubbles">
                    <label class="btn btn-primary btn-option"><input type="radio" name="options">1M</label>
                    <label class="btn btn-primary btn-option"><input type="radio" name="options">3M</label>
                    <label class="btn btn-primary btn-option"><input type="radio" name="options">6M</label>
                    <label class="btn btn-primary btn-option active"><input type="radio" name="options">YTD</label>
                    <label class="btn btn-primary btn-option"><input type="radio" name="options">1Y</label>
                    <label class="btn btn-primary btn-option"><input type="radio" name="options">3Y</label>
                    <label class="btn btn-primary btn-option"><input type="radio" name="options">5Y</label>
                </div>
            </div>
            <input id="option" type="hidden" value="YTD" />
        </div>
        <div class="row">
            <div id="asset-bubbles" style="height:600px;" class="kpi-chart plot-chart" data-kpi-type="bubbles" data-x-axis="Performance" data-y-axis="Volatilité">
                <p class="text-center header-chart">
                    <a class="reset" href="javascript:$k.reset('#assets-bubbles');" style="display: none;"><i class="fa fa-undo"></i></a>
                </p>
            </div>
        </div>

    </div>
</section>


<section class="container">
    <h2>Implémentation</h2>
    <pre class="prettyprint"><xmp>
    <!-- Latest version of d3 librairies -->
    <script src="https://lili.am/Scripts/d3/d3.js" type="text/javascript"></script>
    <!-- Latest version of crossfilter librairies -->
    <script src="https://lili.am/Scripts/Crossfilter/crossfilter.js" type="text/javascript"></script>
    <!-- Latest version of dc librairies -->
    <script src="https://lili.am/Scripts/dc/2.1.7/dc.js" type="text/javascript"></script>
    <!-- Latest version of instrument widgets -->
    <script src="https://lili.am/Scripts/instrument.charts-2.2.js" type="text/javascript"></script>

    </xmp></pre>
        <p>
            Pour notre graphe à bulles, nous avons déclaré son conteneur avec une balise.
        </p>
    <pre class="prettyprint"><xmp>
    <!-- IMPORTANT Local version of widgets activity charts -->
    <script src="~/Scripts/activity-charts-1.2.js" type="text/javascript"></script>
    </xmp></pre>
        <p>Chaque élément pour widget a une propriété <span class="atn">data-chart</span> permettant de définir le type de widget qui sera déployé au sein de l'élément.</p>
    <pre class="prettyprint"><xmp>
    <div id="pnl-counter" class="activity-chart number" data-chart="number" data-number="pnl"></div>
    <div id="rating-pie" class="portfolio-chart pie-chart" data-chart="pie" data-dimension="rating">
        ...
    </div>
    </xmp>
    </pre>

</section>


@section scripts {


    <!-- Latest version of d3 librairies -->
    <script src="https://lili.am/Scripts/d3/d3.js" type="text/javascript"></script>
    <!-- Latest version of crossfilter librairies -->
    <script src="https://lili.am/Scripts/Crossfilter/crossfilter.js" type="text/javascript"></script>
    <!-- Latest version of dc librairies -->
    <script src="https://lili.am/Scripts/dc/2.1.7/dc.js" type="text/javascript"></script>
    <!-- Latest version of calculations on arrays -->
    <script src="https://lili.am/Scripts/jquery-array-stats.js" type="text/javascript"></script>
    <!-- Latest version of instrument widgets -->
    <script src="https://lili.am/Scripts/instrument.charts-2.2.js" type="text/javascript"></script>

    <script>

        $(document).ready(function () {

            // First, we create a new instance of portfolios controller to get data from server with LILI API
            $a = new LoyolApp.AssetsController();
            // create a new instance of activityCharts from the server
            $x = new kpiCharts();
            // we group all the element classed activity-chart
            $x.group($('.kpi-chart'));

            // button to display portfolio historical operations
            $('.kpi-group .btn').click(function () {
                $('#option').val($(this).text());
                // As option, we use here STD for 'Start To Date'; change to YTP or 1M or  ....
                var params = { id: $('#code').val(), option: $(this).text() };
                // Get the data from the server in Json format by calling the method benchmark kpis
                $a.get('benchmarkkpis', params, function (data) {
                    // Then we populate the widgets with data (list of JsonOperation)
                    $x.loaddata(data);
                });
            })

            // button to display portfolio historical operations
            $('.btn-fund').click(function () {
                var code = $(this).data('code');
                $('#code').val(code);
                // As option, we use here STD for 'Start To Date'; change to YTP or 1M or  ....
                var params = { id: code, option: $('#option').val() };
                // Get the data from the server in Json format by calling the method benchmark kpis
                $a.get('benchmarkkpis', params, function (data) {
                    // Then we populate the widgets with data (list of JsonOperation)
                    $x.loaddata(data);
                });
            })

        });

    </script>
}
